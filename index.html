<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Deconfounded GRN: From Observations to Causality</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;max-width:1050px;margin:28px auto;padding:0 16px;line-height:1.55}
    header{border-bottom:1px solid #eee;padding-bottom:14px;margin-bottom:18px}
    h1{margin:0 0 6px 0;font-size:28px}
    .muted{color:#666}
    .card{border:1px solid #eee;border-radius:14px;padding:16px;margin:14px 0;box-shadow:0 1px 10px rgba(0,0,0,.04)}
    .kicker{font-size:13px;letter-spacing:.08em;text-transform:uppercase;color:#666;margin:0 0 8px 0}
    .row{display:grid;grid-template-columns:1.1fr .9fr;gap:14px}
    @media (max-width: 900px){ .row{grid-template-columns:1fr;} }
    .btn{display:inline-block;border:1px solid #ddd;border-radius:10px;padding:8px 10px;text-decoration:none;color:#0b57d0;background:#fafafa}
    .btn:hover{background:#f3f3f3}
    .pdfbox{width:100%;height:620px;border:1px solid #eee;border-radius:12px;overflow:hidden}
    img{max-width:100%;border-radius:12px;border:1px solid #eee}
    code{background:#f6f6f6;padding:2px 6px;border-radius:6px}
 
    .two-col{
      display:grid;
      grid-template-columns: 1.3fr 0.7fr;
      gap:14px;
      align-items:start;
    }
    @media (max-width: 900px){
      .two-col{ grid-template-columns: 1fr; }
    }

  .pdf-aspect{
    width: 100%;
    aspect-ratio: 1 / var(--ratio); /* 宽 / 高 的形式不直观，所以用变量换算 */
    border: 1px solid #eee;
    border-radius: 12px;
    overflow: hidden;
    background: #fff; /* 避免黑底 */
  }
  .pdf-aspect iframe{
    width: 100%;
    height: 100%;
    border: 0;
    display: block;
    background: #fff;
  }
  
    .pdfbox{ width:100%; height:620px; border:1px solid #eee; border-radius:12px; overflow:hidden; }
  
    .zpanel{
      border:1px solid #eee;
      border-radius:14px;
      box-shadow:0 1px 10px rgba(0,0,0,.04);
      background:#fff;
      position:sticky;
      top:16px;             
    }
    .zpanel-header{
      padding:12px;
      border-bottom:1px solid #eee;
      display:flex;
      gap:10px;
      justify-content:space-between;
      align-items:center;
    }
    .zfilter{
      width: 45%;
      min-width: 140px;
      border:1px solid #ddd;
      border-radius:10px;
      padding:8px 10px;
      font-size:13px;
    }
    .zpanel-body{
      max-height: 620px;     
      overflow-y:auto;       
      padding:8px 10px;
    }
    .zrow{
      display:flex;
      justify-content:space-between;
      gap:10px;
      padding:8px 6px;
      border-bottom:1px solid #f0f0f0;
      font-size:13px;
    }
    .zrow:last-child{ border-bottom:none; }
    .zid{ color:#333; font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono"; }
    .zval{ font-weight:600; }
    .zbadge{
      font-size:12px;
      border:1px solid #eee;
      border-radius:999px;
      padding:2px 8px;
      background:#fafafa;
      color:#666;
      margin-left:8px;
    }

  </style>
</head>
<body>
  <header>
    <h1>Observed Dependencies ≠ True Regulation</h1>
    <div class="muted">
      Dense gene–gene dependencies in observational data may reflect regulation, latent confounding, and selection effects.
    </div>
  </header>

  <section class="card">
    <div class="kicker">1. Observation</div>
    <div class="row">
      <div>
        <p>
          We start from the <b>observed dependency graph</b> among genes inferred from observational measurements.
          The graph is often dense, suggesting widespread interactions.
        </p>
        <p>
          But if <i>all</i> dependencies were due to direct regulation, the implied regulatory system would be
          unrealistically complex.
        </p>
      </div>
      <div class="muted">
        <p><b>Key question</b></p>
        <p>
          Should the regulatory network be this dense if dependencies only arise from regulation?
        </p>
        <p>
          We hypothesize that part of the observed structure is induced by <b>latent confounders</b> (e.g., non-coding RNAs)
          and <b>selection</b> (e.g., survival mechanisms, QC filters).
        </p>
      </div>
    </div>
  </section>

  <section class="card">
    <div class="kicker">2. Evidence: Observed dependency graph</div>

    <p>
      Figure: observed dependencies among genes (PDF).
      <a class="btn" href="assets/figures/observed_dependencies.pdf" target="_blank" rel="noopener">Open PDF</a>
      <a class="btn" href="assets/figures/observed_dependencies.pdf" download>Download</a>
    </p>

    <!-- PDF embed (works in most desktop browsers) -->
    <object class="pdfbox" data="assets/figures/observed_dependencies.pdf" type="application/pdf">
      <p class="muted">
        Your browser cannot display embedded PDFs. Please use the “Open PDF” button above.
      </p>
      <!-- Optional fallback image (recommended) -->
      <img src="assets/figures/observed_dependencies.png" alt="Observed dependency graph (preview)" />
    </object>

    <p class="muted">
      Tip: for best compatibility, include a PNG preview at
      <code>assets/figures/observed_dependencies.png</code>.
    </p>
  </section>

  <section class="card" id="sec-3-1">
  <div class="kicker">3.1</div>
  <h2 style="margin-top:0;">Biological constraints such as survival mechanisms are a selection process</h2>

  <div class="two-col">
    <!-- Left: PDF figure -->
    <div>
      <p class="muted" style="margin-top:0;">
        Figure: selection-induced structure (PDF).
        <a class="btn" href="assets/figures/selection_survival.pdf" target="_blank" rel="noopener">Open PDF</a>
      </p>

      <object class="pdfbox" data="assets/figures/selection_survival.pdf" type="application/pdf">
        <div class="pdf-aspect" style="--ratio: 0.62;">
  <iframe
    src="assets/figures/selection_survival.pdf"
    title="Selection survival PDF"
    loading="lazy">
  </iframe>
</div>
      </object>
    </div>

    <!-- Right: scrollable z-score panel -->
    <aside class="zpanel">
      <div class="zpanel-header">
        <div>
          <div style="font-weight:600;">Point z-scores</div>
          <div class="muted" style="font-size:12px;">Scroll to view all points</div>
        </div>
        <input id="zFilter" class="zfilter" placeholder="Filter by id…" />
      </div>

      <div class="zpanel-body" id="zList">
        <!-- JS will render rows here -->
      </div>
    </aside>
  </div>
</section>

  <section class="card">
    <div class="kicker"> Next</div>
    <p>
      Next, we design algorithms to disentangle <b>causal regulation</b>, <b>latent confounding</b>, and <b>selection</b>.
      (Add links to method/results pages here when ready.)
    </p>
    <p class="muted">
      Suggested next pages: <code>runs/method.html</code>, <code>runs/results.html</code>
    </p>
  </section>
<script>
  // Example z-score data: replace with your real values
  // id 可以是 “点编号”、或 “gene name”、或 “(i,j)” 等
  const zscores = [
    { id: "p001", z: 2.41 },
    { id: "p002", z: -0.87 },
    { id: "p003", z: 1.12 },
    { id: "p004", z: 3.05 },
    // ...
  ];

  function fmtZ(z){
    const sign = z >= 0 ? "+" : "";
    return `${sign}${z.toFixed(2)}`;
  }

  function renderZ(list){
    const container = document.getElementById("zList");
    container.innerHTML = "";
    for (const item of list){
      const row = document.createElement("div");
      row.className = "zrow";

      // optional: significance badge
      const badge = Math.abs(item.z) >= 1.96 ? "sig" : "ns";

      row.innerHTML = `
        <div>
          <span class="zid">${item.id}</span>
          <span class="zbadge">${badge}</span>
        </div>
        <div class="zval">${fmtZ(item.z)}</div>
      `;
      container.appendChild(row);
    }
  }

  // initial render
  renderZ(zscores);

  // simple filter
  const filter = document.getElementById("zFilter");
  filter.addEventListener("input", (e) => {
    const q = e.target.value.trim().toLowerCase();
    if (!q) return renderZ(zscores);
    renderZ(zscores.filter(d => d.id.toLowerCase().includes(q)));
  });
</script>
</body>
</html>
